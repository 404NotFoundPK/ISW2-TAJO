<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  -->

<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>org.apache</groupId>
    <artifactId>apache</artifactId>
    <version>15</version>
  </parent>
  <groupId>org.apache.tajo</groupId>
  <artifactId>tajo-main</artifactId>
  <version>0.12.0-SNAPSHOT</version>
  <description>Tajo Main</description>
  <url>http://tajo.apache.org/</url>
  <name>Tajo Main</name>
  <packaging>pom</packaging>

  <licenses>
    <license>
      <name>The Apache Software License, Version 2.0</name>
      <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
    </license>
  </licenses>

  <organization>
    <name>The Apache Software Foundation</name>
    <url>http://www.apache.org/</url>
  </organization>

  <issueManagement>
    <system>Jira</system>
    <url>https://issues.apache.org/jira/browse/TAJO</url>
  </issueManagement>

  <ciManagement>
    <system>Jenkins</system>
    <url>https://builds.apache.org</url>
  </ciManagement>

  <scm>
    <url>https://github.com/apache/tajo.git</url>
    <connection>scm:git:https://github.com/apache/tajo.git</connection>
    <developerConnection>scm:git:https://github.com/apache/tajo.git</developerConnection>
    <tag>HEAD</tag>
  </scm>

  <repositories>
    <repository>
      <id>eclipse-jetty</id>
      <url>https://repo2.maven.org/maven2/org/eclipse/jetty/jetty-distribution/</url>
      <snapshots>
        <enabled>false</enabled>
      </snapshots>
    </repository>
    <repository>
      <id>pentaho-public</id>
      <name>Pentaho Public</name>
      <url>https://repo.orl.eng.hitachivantara.com/artifactory/pnt-mvn/</url>
    </repository>
  </repositories>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    <tajo.root>${basedir}</tajo.root>
	
	<sonar.organization>404notfoundpk</sonar.organization>
	<sonar.host.url>https://sonarcloud.io</sonar.host.url>
	<sonar.links.homepage>https://github.com/404NotFoundPK/ISW2-tajo</sonar.links.homepage>
	<sonar.links.ci>https://travis-ci.org/404NotFoundPK/ISW2-tajo</sonar.links.ci>
	<sonar.links.scm>https://github.com/404NotFoundPK/ISW2-tajo</sonar.links.scm>
	<sonar.links.issue>https://github.com/404NotFoundPK/ISW2-tajo/issues</sonar.links.issue>
	  
	  <jacoco-maven-plugin.version>0.8.6</jacoco-maven-plugin.version>
	    <aggregate.report.dir>tajo-coverage/target/site/jacoco-aggregate/jacoco.xml</aggregate.report.dir>
	    <testRetryCount>2</testRetryCount>
	<maven-surefire-plugin.version>3.0.0-M5</maven-surefire-plugin.version>
	<maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
  </properties>
	
 <!-- dependencies for all modules -->
<dependencyManagement>
    <dependencies>
	    <dependency>
	    <groupId>org.pentaho</groupId>
	    <artifactId>pentaho-aggdesigner-algorithm</artifactId>
	    <version>5.1.5-jhyde</version>
	    <scope>system</scope>
	    <systemPath>${pom.basedir}/lib/pentaho-aggdesigner-algorithm-5.1.5-jhyde.jar</systemPath>
	</dependency>
	<dependency>
	    <groupId>mysql</groupId>
	    <artifactId>mysql-connector-java</artifactId>
	    <version>5.1.39</version>
	</dependency>
</dependencies>
</dependencyManagement>
  <dependencies>
	<dependency>
	    <groupId>org.pentaho</groupId>
	    <artifactId>pentaho-aggdesigner-algorithm</artifactId>
	    <version>5.1.5-jhyde</version>
	    <scope>system</scope>
	    <systemPath>${pom.basedir}/lib/pentaho-aggdesigner-algorithm-5.1.5-jhyde.jar</systemPath>
	</dependency>
	  <dependency>
	    <groupId>mysql</groupId>
	    <artifactId>mysql-connector-java</artifactId>
	    <version>5.1.39</version>
	</dependency>
</dependencies>
  <modules>
    <module>tajo-maven-plugins</module>
    <module>tajo-project</module>
    <module>tajo-common</module>
    <module>tajo-algebra</module>
    <module>tajo-plan</module>
    <module>tajo-core</module>
    <module>tajo-rpc</module>
    <module>tajo-catalog</module>
    <module>tajo-client</module>
    <module>tajo-client-example</module>
    <module>tajo-jdbc</module>
    <module>tajo-sql-parser</module>
    <module>tajo-storage</module>
    <module>tajo-pullserver</module>
    <module>tajo-yarn</module>
    <module>tajo-thirdparty/asm</module>
    <module>tajo-cli</module>
    <module>tajo-metrics</module>
    <module>tajo-core-tests</module>
    <module>tajo-cluster-tests</module>
    <module>tajo-tablespace-example</module>
    <module>tajo-dist</module>
    <module>tajo-coverage</module>
  </modules>

  <build>
    <pluginManagement>
      <plugins>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-dependency-plugin</artifactId>
          <version>2.4</version>
        </plugin>
        <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>${maven-surefire-plugin.version}</version>
        <configuration>
          <testFailureIgnore>true</testFailureIgnore>
          <argLine>-Xmx2G -Djava.net.preferIPv4Stack=true -Dio.netty.leakDetection.level=paranoid</argLine>
          <redirectTestOutputToFile>${redirectTestOutputToFile}</redirectTestOutputToFile>
          <forkCount>${forkCount.variable}</forkCount>
          <reuseForks>false</reuseForks>
          <trimStackTrace>false</trimStackTrace>
          <forkedProcessTimeoutInSeconds>1800</forkedProcessTimeoutInSeconds>
          <rerunFailingTestsCount>${testRetryCount}</rerunFailingTestsCount>
        </configuration>
      </plugin>
        <plugin>
             <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.5.1</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                </configuration>
            </plugin>
	<plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-enforcer-plugin</artifactId>
          <version>1.4</version>
          <configuration>
            <rules>
              <requireMavenVersion>
                <version>[3.0.2,)</version>
              </requireMavenVersion>
              <requireJavaVersion>
                <version>1.8</version>
              </requireJavaVersion>
            </rules>
          </configuration>
        </plugin>
	<plugin>
          <groupId>org.sonarsource.scanner.maven</groupId>
          <artifactId>sonar-maven-plugin</artifactId>
          <version>3.4.0.905</version>
        </plugin>
	<plugin>
          <groupId>org.jacoco</groupId>
          <artifactId>jacoco-maven-plugin</artifactId>
          <version>0.8.4</version>
        </plugin>
        <plugin>
          <artifactId>maven-assembly-plugin</artifactId>
          <version>2.4.1</version>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-deploy-plugin</artifactId>
          <version>2.5</version>
        </plugin>

        <plugin>
          <groupId>org.apache.rat</groupId>
          <artifactId>apache-rat-plugin</artifactId>
          <version>0.12</version>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-site-plugin</artifactId>
          <version>3.0</version>
          <dependencies>
            <dependency><!-- add support for ssh/scp -->
              <groupId>org.apache.maven.wagon</groupId>
              <artifactId>wagon-ssh</artifactId>
              <version>1.0</version>
            </dependency>
          </dependencies>
        </plugin>
      </plugins>
    </pluginManagement>

    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-enforcer-plugin</artifactId>
        <inherited>false</inherited>
        <executions>
          <execution>
            <id>clean</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <phase>pre-clean</phase>
          </execution>
          <execution>
            <id>default</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <phase>validate</phase>
          </execution>
          <execution>
            <id>site</id>
            <goals>
              <goal>enforce</goal>
            </goals>
            <phase>pre-site</phase>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>

  <profiles>
<profile>
	<id>coverage</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<build>
				<plugins>
					<plugin>
					    <groupId>org.jacoco</groupId>
					    <artifactId>jacoco-maven-plugin</artifactId>
					    <version>${jacoco-maven-plugin.version}</version>
					    <executions>
					      <execution>
						<id>prepare-agent</id>
						<goals>
						  <goal>prepare-agent</goal>
						</goals>
					      </execution>
					    </executions>
					  </plugin>
				</plugins>
			</build>
		</profile>
  </profiles>
</project>
